2015-03-30  Jose E. Marchesi  <jemarch@gnu.org>

	* lib/Makefile.am: Updated.
	* src/config.h.in: Likewise.

2015-03-30  Jose E. Marchesi  <jemarch@gnu.org>

	install plugins without the 'lib' prefix.
	* src/plugins/fail_mem/Makefile.am (lib_LTLIBRARIES): libfail_mem
	renamed to fail_mem.
	(fail_mem_la_SOURCES): Renamed from libfail_mem_la_SOURCES.
	(fail_mem_la_LDFLAGS): Renamed from libfail_mem_la_LDFLAGS.
	* src/plugins/fail_mem/Makefile.am (libfail_mem_la_LDFLAGS): Use
	-module.

	* src/plugins/inhibit/Makefile.am (lib_LTLIBRARIES): libinhibit
	renamed to inhibit.
	(inhibit_la_SOURCES): Renamed from libinhibit_la_SOURCES.
	(inhibit_la_LDFLAGS): Renamed from libinhibit_la_LDFLAGS.
	(inhibit_la_LDFLAGS): Use -module.

2015-03-29  Jose E. Marchesi  <jemarch@gnu.org>

	* src/plugins.c: header fixed.
	* src/plugins.h: Likewise.

2015-03-29  Jose E. Marchesi  <jemarch@gnu.org>

	* doc/cockroach.texi: Copyright years updated.
	* doc/Makefile.am: Likewise.

2015-03-29  Jose E. Marchesi  <jemarch@gnu.org>

	* src/Makefile.am (cockroach_LDADD): Use $top_builddir in paths.
	* src/plugins/inhibit/Makefile.am (AM_CFLAGS): Use $srcdir in
	paths.

2015-03-29  Jose E. Marchesi  <jemarch@gnu.org>

	* src/cockroach.c (cockroach_print_version): Copyright years updated.

2015-03-29  Jose E. Marchesi  <jemarch@gnu.org>

	* .gitignore: updated.

2015-03-29  Jose E. Marchesi  <jemarch@gnu.org>

	copyright years updated and program name fixed in notices.
	* src/bitmap.c: Fix program name in copyright notice, and update
	year.
	* README-dev: Likewise.
	* Makefile.am: Likewise.
	* ChangeLog: Likewise.
	* tests/test_bitmap.c: Likewise.
	* tests/Makefile.am: Likewise.
	* src/plugins/inhibit/Makefile.am: Likewise.
	* src/plugins/inhibit/inhibit.c: Likewise.
	* src/arch/linux_generic.c: Likewise.
	* src/arch/linux_i386.c: Likewise.
	* src/plugins.c: Likewise.
	* src/Makefile.am: Likewise.
	* src/bitmap.h: Likewise.

2015-03-24  Giuseppe Scrivano  <gscrivan@redhat.com>

	* src/cockroach.c (main): roach_wait doesn't return a status
	anymore.
	* src/roach.c (roach_wait): Wake up stopped processes.

2015-03-21  Giuseppe Scrivano  <gscrivan@redhat.com>

	* src/roach.c (roach_rot_process): Trace child processes too.

	* src/cockroach.c (main): do not process arguments to the process.

	* src/plugins/inhibit/inhibit.c (plugin_add): Permit to specify
	return code.

	* README: Improve description.

2015-03-17  Giuseppe Scrivano  <gscrivan@redhat.com>

	* src/Makefile.am (cockroach_LDADD): Use libcockroach.la not
	libcockroach.a.
	* tests/Makefile.am (cockroach_LDADD): Likewise.
	* src/roach.h: Include <config.h>.
	* src/plugins/fail_mem/fail_mem.c (plugin_add): Check if __NR_mmap2
	exists before using it.

2014-06-28  Giuseppe Scrivano  <gscrivan@redhat.com>

	* configure.ac: Remove spurious AC_CONFIG_HEADERS.

	* configure.ac: Use external gettext.
	* bootstrap.conf (gnulib_modules): Remove gettext module.

	* bootstrap: Update from gnulib.

2011-12-07  Giuseppe Scrivano  <giuseppe@southpole.se>

	locate a program in PATH.
	* src/roach.c (roach_rot_process): Use execvp instead of execvp.

2011-11-25  Giuseppe Scrivano  <gscrivano@gnu.org>

	do not use syscall magic numbers.
	* src/plugins/fail_mem/fail_mem.c: Include <syscall.h>
	(plugin_add): Use __NR_brk and __NR_mmap2 instead of magic numbers.

2011-11-25  Giuseppe Scrivano  <giuseppe@southpole.se>

	fail_mem: new plugin.
	* configure.ac: Generate the makefile for the fail_mem plugin.
	* src/plugins/Makefile.am (SUBDIRS): Add fail_mem.
	* src/plugins/fail_mem/fail_mem.c (libfail_mem_la_LDFLAGS): New file.
	* src/plugins/fail_mem/Makefile.am (libfail_mem_la_LDFLAGS): New file.

	fix syscall return value register.
	* src/arch/linux_i386.c (SC_RET_ADDR): Fix syscall return register.
	* src/arch/linux_x86_64.c (SC_RET_ADDR): Likewise.

	fix test suite build.
	* tests/Makefile.am (LDADD): Use libroach.la instead of libroach.a

	add plugins support.
	* src//plugins.h: New file.
	* src/plugins.c: Likewise.
	* src/plugins/plugin.h: Likewise.
	* src/plugins/Makefile.am: Likewise.
	* src/plugins/inhibit/Makefile.am: Likewise.
	* src/plugins/inhibit/inhibit.c: Likewise.
	* Makefile.am: Generate the library using libtool.
	(SUBDIRS): Add plugins.
	* configure.ac: Look for libtool.  Update makefiles list.
	* cockroach.c: Include "plugins.h".
	(long_options): Add PLUGIN_ARG and PLUGIN_ADD_ARG.
	(main): Handle PLUGIN_ARG and PLUGIN_ADD_ARG.  Remove inhibit handler
	used by default.

2011-11-12  Jose E. Marchesi  <jemarch@gnu.org>

	warnings fixes.
	* src/roach.c: Include unistd.h.
	Include sys/wait.h.
	(roach_rot_function): Pass NULL to wait.
	(roach_rot_process): Likewise.

	* src/bitmap.c (needed_size): Do something useful.
	(roach_bitmap_flip_all): Return something.

2011-11-12  Jose E. Marchesi  <jemarch@gnu.org>

	* src/arch/linux_generic.c (roach_syscall_inhibit): Cast to long
	to avoid truncation in 64bit platforms.

2011-11-08  Giuseppe Scrivano  <giuseppe@southpole.se>

	* src/roach.h: Declare roach_get_sc_ret.
	* src/roach.c (roach_get_sc_ret): New function.

	* src/roach.h: Rename roach_spawn_process to roach_rot_process.  Define
	new function roach_rot_function.
	* src/roach.c (roach_spawn_process): Rename to...
	(roach_rot_process): ...this.
	(roach_rot_function): New function.

	* src/cockroach.c (main): Fix roach_rot_process call.

	* src/roach.c (roach_reg_syscall): Pass correctly the DATA argument to
	the roach_make_hook function.

	* src/arch/linux_generic.c (OFFSET) [! OFFSET]: Define macro.
	* src/arch/linux_i386.c (OFFSET): Remove definition.
	* src/arch/linux_x86_64.c (OFFSET): Likewise.

	* src/roach.h (roach_get_sc): Change return type to long.
	(roach_set_sc): Likewise.
	(roach_set_sc_ret): Likewise.
	(roach_get_sc_arg): Likewise.
	(roach_set_sc_arg): Likewise.
	* src/arch/linux_generic.c (roach_get_sc): Change return type to long.
	(roach_set_sc): Likewise.
	(roach_set_sc_ret): Likewise.
	(roach_get_sc_arg): Likewise.
	(roach_set_sc_arg): Likewise.

2011-11-06  Giuseppe Scrivano  <gscrivano@gnu.org>

	* src/Makefile.am (EXTRA_DIST): Add arch/linux_i386.c and
	arch/linux_x86_64.c.

	* tests/Makefile.am (AM_CFLAGS): Specify the absolute path to src as
	argument to the compiler.

	* src/cockroach.c (cockroach_print_version): List authors in alphabetical
	order.

	* configure.ac: Fix the regex to detect the i[3456]86-*-linux-* host.

	* src/cockroach.c: Include <locale.h> for LC_ALL.

2011-11-06  Jose E. Marchesi  <jemarch@gnu.org>

	.gitignored update.
	* .gitignore: Updated.

2011-11-06  Jose E. Marchesi  <jemarch@gnu.org>

	gettextized and getoptized.
	* src/Makefile.am (AM_CPPFLAGS): Define LOCALEDIR.

	* src/cockroach.c (long_options): New variable.
	(cockroach_print_help): New function.
	(cockroach_print_version): New function.
	(main): Process command line arguments with getopt.
	(main): Initialize gettext, the program name and use close_stdout.

	* configure.ac: Generate src/config.h.

	* bootstrap.conf (gnulib_modules): Modules getopt-gnu, closeout,
	gettext, gettext-h, xalloc and progname added.

2011-11-06  Jose E. Marchesi  <jemarch@gnu.org>

	Support for multiple hardware architectures, and x86_64 added.
	* src/Makefile.am (EXTRA_libroach_a_SOURCES): Defined to allow
	conditional compilation depending on the host architecture.

	* configure.ac: Detect host architecture and set and subst
	ROACH_ARCH.  Emit an error if the architecture is not supported by
	libroach.

	* src/arch/linux_generic.c: New comment describing the macros
	required for the generic functions to work.

	* src/arch/linux_i386.c: Reduced to define the constants
	SC_REG_SIZE, SC_REG_ADDR, SC_RET_ADDR, SC_ARG[1-5]ADDR and OFFSET.

	* src/arch/linux_generic.c (roach_get_sc): Moved from linux_i386.c
	and made generic.
	(roach_set_sc): Likewise.
	(roach_set_sc_ret): Likewise.
	(roach_set_sc_arg): Likewise.
	(roach_get_sc_arg): Likewise.
	(roach_write_mem): Likewise.
	(roach_read_mem): Likewise.

2011-11-06  Jose E. Marchesi  <jemarch@gnu.org>

	Build libroach and the cockroach utility.
	* src/arch/linux_i386.c: Include roach.h.

	* src/Makefile.am: Copyright updated.
	(include_HEADERS): roach.h from cockroach.h.
	(libroach_a_SOURCES): roach.c from libroach.c.

	* src/cockroach.c: Include roach.h.

	* src/roach.h: Renamed from src/cockroach.h.

	* src/roach.c: Renamed from src/libroach.c and description
	updated.
	Include roach.h instead of cockroach.h.

2011-11-06  Jose E. Marchesi  <jemarch@gnu.org>

	SYSCALL_TYPE renamed to HOOK_TYPE.
	* src/cockroach.h (enum HOOK_TYPE): Renamed from enum
	SYSCALL_TYPE.
	(s_hook): Use HOOK_TYPE.
	(roach_make_hook): Likewise.
	* src/libroach.c (roach_make_hook): Likewise.

2011-11-06  Jose E. Marchesi  <jemarch@gnu.org>

	Legal and minor cosmetic changes.
	* README-dev: Copyright notification fixed.

	* AUTHORS: Initial content.

	* Changelog: Copyright notification added at the end.

	* src/cockroach.c: Unify source headers.

2011-10-31  Jose E. Marchesi  <jco@terma.com>

	bootstrap: check for README-dev to decide this is a check-out
	tree.
	* bootstrap (checkout_only_file): Check for README-dev to
	determine this is a check-out tree.

	* README-dev: New file.

2011-10-31  Jose E. Marchesi  <jco@terma.com>

	manual: initial stub.
	* doc/cockroach.texi: New file.
	(Overview): Stub chapter with no real contents.
	* doc/fdl.texi: New file.
	* doc/Makefile.am: New file.

	* src/cockroach.c: Header and copyright notification.

2011-10-31  Jose E. Marchesi  <jemarch@gnu.org>

	* README: New file.

Copyright 2011-2015 Jose E. Marchesi
Copyright 2011-2015 Giuseppe Scrivano

Copying and distribution of this file, with or without modification, are
permitted in any medium without royalty provided the copyright notice
and this notice are preserved.
